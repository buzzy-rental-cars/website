<%= nested_form_for @page, html: { multipart: true, role: "form", class: "form-horizontal" } do |f| %>
  <%= render "shared/error_messages", target: @page %>
  <div class="form-group">
    <%= f.label :name, "Name", class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_field :name, class: "form-control" %>
    </div>
  </div>
  <div class="form-group">
    <%= f.label :body, "Body", class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_area :body, class: "form-control", rows: "10" %>
    </div>
  </div>
  <div class="form-group">
    <label>Illustrations</label>
    <%= f.fields_for :illustrations do |illustration_form| %>
      <div class="illustration">
        <div class="form-group">
          <%= f.label :illustration, "Illustration", class: "col-sm-2 control-label" %>
          <div class="col-sm-offset-2 col-sm-10">
            <%= image_tag(illustration_form.object.illustration_url(:thumbnail)) if illustration_form.object.illustration? %>
            <% if illustration_form.object.illustration? %>
              <p>File name: <%= File.basename(illustration_form.object.illustration.path) %></p>
            <% end %>
            <%= illustration_form.file_field :illustration, class: "form-control" %>
            <%= illustration_form.hidden_field :illustration_cache %>
            <%= illustration_form.link_to_remove "Remove illustration" %>
          </div>
        </div>
      </div>
    <% end %>
    <p><%= f.link_to_add "Add illustration", :illustrations %></p>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <div class="checkbox">
        <label><%= f.check_box :published %>Publish this page?</label>
      </div>
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <%= f.submit class: "btn btn-default" %>
    </div>
  </div>
<% end %>
